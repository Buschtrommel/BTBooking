var newTimes=0;function btb_render_input(k,m,a,h,b,e,l,c,j,n){var g=[];var f="btb_new_times_"+newTimes+"_"+a;var d="";var i="";if(h){if(k==="checkbox"){d='<span class="btb_admin_desc">'+h+"</span>"}else{d='<p class="btb_admin_desc">'+h+"</p>"}}g.push("<tr>",'<th scope="row"><label for="',f,'">',m,"</label></th>","<td>",'<input type="',k,'"',' id="',f,'"',' name="btb_new_times[',newTimes,"][",a,']"',' data-time-id="',newTimes,'"',b?' onchange="'+b+'"':"",e?' min="'+e+'"':"",l?' max="'+l+'"':"",c?' step="'+c+'"':"",j?' class="'+j+'"':"",n?' value="'+n+'"':""," />",h?d:"","</td>","</tr>");return g.join("")}function btb_render_name_header(b){var c=[];var a=new Date();c.push('<div class="btb_time_header" data-time-id="',newTimes,'" onclick="btb_toggle_content(this)"><h4 id="btb_new_times_',newTimes,'_header">',jQuery.datepicker.formatDate(BTBooking.date_format,new Date()),'</h4><a class="btb_delete_time" href="#" onclick="btb_remove_new_time(this)">remove</a></div>');return c.join("")}function btb_render_times_entry(){var b=[];var a="btb_new_time_"+newTimes;b.push('<div id="',a,'" class="btb_new_time btb_time_box">',btb_render_name_header(a),'<input type="hidden" name="btb_new_times[',newTimes,'][time_name]" id="btb_new_times_',newTimes,'_time_name" value="',jQuery.datepicker.formatDate(BTBooking.date_format,new Date()),'" />','<input type="hidden" name="btb_new_times[',newTimes,'][start_date_secs]" id="btb_new_times_',newTimes,'_start_date_secs" value="',jQuery.datepicker.formatDate("@",new Date()),'" />','<input type="hidden" name="btb_new_times[',newTimes,'][end_date_secs]" id="btb_new_times_',newTimes,'_end_date_secs" value="',jQuery.datepicker.formatDate("@",new Date()),'" />','<table id="btb_new_times_',newTimes,'_table" class="form-table"><tbody>',btb_render_input("text",BTBooking.strings["Start date"],"start_date",null,"btb_update_name_header(this)",null,null,null,"btb_start_date btb_date_picker",jQuery.datepicker.formatDate(BTBooking.date_format,new Date())),btb_render_input("text",BTBooking.strings["End date"],"end_date",null,"btb_update_name_header(this)",null,null,null,"btb_end_date btb_date_picker",jQuery.datepicker.formatDate(BTBooking.date_format,new Date())),btb_render_input("checkbox",BTBooking.strings["Date only"],"date_only",BTBooking.strings.date_only_desc,"btb_toggle_time_input(this)"),btb_render_input("number",BTBooking.strings.Slots,"slots",null,null,1,null,1,null,5),btb_render_input("number",BTBooking.strings.Price,"price",null,null,0),"</tbody></table></div>");return b.join("")}function btb_delete_time(b){var a=jQuery(b);if(jQuery("#btb_times_"+a.data("time-id")+"_delete").val()=="false"){jQuery("#btb_times_"+a.data("time-id")+"_header").addClass("header_delete");a.html(BTBooking.strings.cancel);jQuery("#btb_times_"+a.data("time-id")+"_delete").val("true")}else{jQuery("#btb_times_"+a.data("time-id")+"_header").removeClass("header_delete");a.html(BTBooking.strings["delete"]);jQuery("#btb_times_"+a.data("time-id")+"_delete").val("false")}}function btb_update_name_header(f){var c=jQuery(f);if(c.val()!==undefined){var a=jQuery.datepicker.parseDate(BTBooking.date_format,jQuery("#btb_new_times_"+c.data("time-id")+"_start_date").val());var d=jQuery.datepicker.parseDate(BTBooking.date_format,jQuery("#btb_new_times_"+c.data("time-id")+"_end_date").val());jQuery("#btb_new_times_"+c.data("time-id")+"_start_date_secs").val(jQuery.datepicker.formatDate("@",a));jQuery("#btb_new_times_"+c.data("time-id")+"_end_date_secs").val(jQuery.datepicker.formatDate("@",d));var b="";if(a.getDate()!==d.getDate()||a.getMonth()!==d.getMonth()||a.getFullYear()!==d.getFullYear()){b=jQuery.datepicker.formatDate(BTBooking.date_format,a)+" - "+jQuery.datepicker.formatDate(BTBooking.date_format,d)}else{b=jQuery.datepicker.formatDate(BTBooking.date_format,a)}jQuery("#btb_new_times_"+c.data("time-id")+"_header").html(b);jQuery("#btb_new_times_"+c.data("time-id")+"_time_name").val(b)}}function btb_update_name_header_saved(j){var o=jQuery(j);if(o.val()!==undefined){var d=jQuery.datepicker.parseDate(BTBooking.date_format,jQuery("#btb_times_"+o.data("time-id")+"_start_date").val());var m=jQuery.datepicker.formatDate("M d, yy",d,{monthNamesShort:jQuery.datepicker.regional.en.monthNamesShort});m+=" ";m+=jQuery("#btb_times_"+o.data("time-id")+"_start_time").val();m+=":00";var c=new Date(m);var h=jQuery.datepicker.parseDate(BTBooking.date_format,jQuery("#btb_times_"+o.data("time-id")+"_end_date").val());var n=jQuery.datepicker.formatDate("M d, yy",h,{monthNamesShort:jQuery.datepicker.regional.en.monthNamesShort});m+=" ";m+=jQuery("#btb_times_"+o.data("time-id")+"_end_time").val();m+=":00";var i=new Date(n);jQuery("#btb_times_"+o.data("time-id")+"_start_date_secs").val(jQuery.datepicker.formatDate("@",c));jQuery("#btb_times_"+o.data("time-id")+"_end_date_secs").val(jQuery.datepicker.formatDate("@",i));var g=jQuery("#btb_times_"+o.data("time-id")+"_date_only").prop("checked");var b="";if(c.getDate()!==i.getDate()||c.getMonth()!==i.getMonth()||c.getFullYear()!==i.getFullYear()){b=jQuery.datepicker.formatDate(BTBooking.date_format,c)+" - "+jQuery.datepicker.formatDate(BTBooking.date_format,i)}else{if(g){b=jQuery.datepicker.formatDate(BTBooking.date_format,c)}else{var l=c.getHours();var f=c.getMinutes();var a=((l<10)?"0"+l:l);var k=((f<10)?"0"+f:f);b=jQuery.datepicker.formatDate(BTBooking.date_format,c)+" "+a+":"+k}}jQuery("#btb_times_"+o.data("time-id")+"_header").html(b);jQuery("#btb_times_"+o.data("time-id")+"_time_name").val(b)}}function btb_remove_new_time(b){var a=jQuery(b);a.parent().parent().remove();newTimes--;jQuery("#btb_new_times_count").val(newTimes)}function btb_toggle_content(b){var a=jQuery(b);a.siblings("table").toggle()}function btb_toggle_time_input(a){}jQuery(document).ready(function(){jQuery(".btb_date_picker").datepicker({dateFormat:BTBooking.date_format});jQuery("#add_time").click(function(){jQuery("#times_container").append(btb_render_times_entry());jQuery("#btb_new_times_count").val(newTimes);jQuery(".btb_date_picker").datepicker({dateFormat:BTBooking.date_format});newTimes++});jQuery("input[name=btb_struct_data_type]:radio").click(function(){if(jQuery("input[name=btb_struct_data_type]:checked").val()!="event"){jQuery("#eventTypeRow").hide();jQuery("#venueRow").hide()}else{jQuery("#eventTypeRow").show();jQuery("#venueRow").show()}})});